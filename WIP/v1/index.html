<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <meta name="theme-color" content="#0a0a0a" />
    <title>The Website</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin />
    <link rel="preload" href="assets/js/CRTConfig.js" as="script" />
    <link rel="preload" href="assets/js/CRTSystem.js" as="script" />
    <link rel="preload" href="assets/css/crt.css" as="style" />
    <link rel="dns-prefetch" href="//fonts.googleapis.com" />
    <link rel="dns-prefetch" href="//fonts.gstatic.com" />
    <link rel="dns-prefetch" href="//cdn.jsdelivr.net" />
    <link
      href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700;800&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/hack-font@3/build/web/hack.css"
      rel="stylesheet"
    />
    <link href="assets/css/crt.css" rel="stylesheet" />

    <style>
      /* Critical CSS - Above-the-fold optimizations */
      :root {
        --vh: 1vh;
        --font-ui: "JetBrains Mono", "Hack", "Hack Nerd Font Mono", monospace;
        --bg: #0a0a0a;
        --fg: #e8e3d8;
        --cyan: #00ffc8;
        --vhs-warm: #ffdc80;
        --fade-dur: 9s;
        --period: 7s;
        --ui-bottom-pad: 72px;
        --bg-current: none;
        --sweep-dur: 25s;

        /* Performance-aware animation durations */
        --anim-fast: 0.15s;
        --anim-medium: 0.3s;
        --anim-slow: 0.6s;
      }

      /* Critical rendering optimizations */
      * {
        -webkit-tap-highlight-color: transparent;
        box-sizing: border-box;
      }

      html,
      body {
        height: 100%;
        margin: 0;
        padding: 0;
      }

      body {
        color: var(--fg);
        font-family: var(--font-ui);
        overflow: hidden;
        -webkit-font-smoothing: antialiased;
        text-rendering: optimizeLegibility;
        width: 100vw;
        height: 100vh;
        position: relative;

        /* Immediate visibility */
        opacity: 1;
        visibility: visible;
      }

      /* Background styling handled by crt.css */

      .bg-image.active {
        opacity: 1;
      }

      header {
        min-height: calc(var(--vh) * 100);
        display: flex;
        flex-direction: column;
        justify-content: flex-end;
        align-items: center;
        text-align: center;
        z-index: 20;
        pointer-events: none;
        padding-bottom: calc(
          env(safe-area-inset-bottom, 0px) + var(--ui-bottom-pad)
        );
        text-shadow: 0 0 1px rgba(0, 0, 0, 0.9), 0 0 8px rgba(0, 0, 0, 0.6);
        gap: clamp(0.5rem, 2vh, 1rem);
        position: relative;
      }

      /* Critical title styling to prevent layout shift */
      #glitch-title {
        pointer-events: none;
        position: relative;
        z-index: 21;
      }

      #glitch-title .tg-letter {
        font-size: clamp(1.99rem, 5.2vw, 4.28rem);
        font-weight: 800;
        letter-spacing: 0.02em;
        line-height: 1.05;
        display: inline-block;

        color: #e8e3d8;
        text-shadow: 0 0 2px currentColor, 0 0 6px rgba(232, 227, 216, 0.6),
          0 0 12px rgba(232, 227, 216, 0.3), 0 0 24px rgba(0, 255, 200, 0.1);
        filter: brightness(1.1) contrast(1.05);
      }

      /* Essential navigation styling */
      nav {
        display: flex;
        gap: clamp(1rem, 3vw, 2rem);
        z-index: 22;
        pointer-events: auto;
      }

      nav a {
        color: var(--fg);
        text-decoration: none;
        font-size: clamp(0.9rem, 2.2vw, 1.1rem);
        font-weight: 400;
        letter-spacing: 0.02em;
        padding: 0.3em 0;
        transition: all var(--anim-fast) ease;
        position: relative;
      }

      /* Navigation list styling */
      #nav-list {
        list-style: none;
        padding: 0;
        margin: 0;
        display: flex;
        gap: clamp(1.2rem, 4.8vw, 2.6rem);
        flex-wrap: wrap;
        justify-content: center;
        pointer-events: auto;
      }

      #nav-list a {
        color: #e8e3d8;
        text-decoration: none;
        font-size: clamp(1.05rem, 2.6vw, 1.6rem);
        letter-spacing: 0.02em;
        padding: 0.15em 0.32em;
        position: relative;
        transition: color 0.2s ease, text-shadow 0.2s ease;

        text-shadow: 0 0 1px currentColor, 0 0 4px rgba(232, 227, 216, 0.4),
          0 0 8px rgba(232, 227, 216, 0.2);

        cursor: pointer;
      }

      #nav-list a:hover {
        color: #00ffc8;
        text-shadow: 0 0 2px currentColor, 0 0 6px rgba(0, 255, 200, 0.6),
          0 0 12px rgba(0, 255, 200, 0.3), 0 0 24px rgba(0, 255, 200, 0.15);
      }

      /* Performance optimizations */
      .perf-low * {
        animation-duration: calc(var(--anim-medium) * 3) !important;
        transition-duration: calc(var(--anim-fast) * 2) !important;
      }

      .perf-medium * {
        animation-duration: calc(var(--anim-medium) * 1.5) !important;
        transition-duration: calc(var(--anim-fast) * 1.3) !important;
      }

      /* Motion reduction preferences */
      @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
        }
      }

      /* Critical mini-window overlay styling */
      #mini-overlay {
        position: fixed;
        inset: 0;
        z-index: 1000;
        display: none;
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(4px);
        align-items: center;
        justify-content: center;
      }

      #mini-overlay.active {
        display: flex;
      }

      /* Override mini positioning for centering */
      #mini-overlay .mini {
        position: relative !important;
        left: auto !important;
        top: auto !important;
        transform: none !important;
        margin: auto;
      }

      /* Loading state optimization */
      body[data-loading="true"] {
        cursor: wait;
      }

      body[data-loading="true"] * {
        pointer-events: none;
      }

      /* Critical CRT effect layer base styling */
      .vhs-signal-layer,
      .crt-flicker-layer,
      .crt-phosphor-dots,
      .crt-scanlines,
      .vhs-head-switch,
      .vhs-chroma-noise,
      .composite-artifacts,
      .crt-vignette,
      .vhs-tracking-error,
      .vhs-dropout,
      .crt-retrace-sweep,
      .vhs-sweep {
        position: fixed;
        inset: 0;
        pointer-events: none;
        z-index: 10;
        display: none;
      }

      /* Show effects when motion is active */
      [data-motion="active"] .vhs-signal-layer,
      [data-motion="active"] .crt-flicker-layer,
      [data-motion="active"] .crt-phosphor-dots,
      [data-motion="active"] .crt-scanlines,
      [data-motion="active"] .vhs-head-switch,
      [data-motion="active"] .vhs-chroma-noise,
      [data-motion="active"] .composite-artifacts,
      [data-motion="active"] .crt-vignette,
      [data-motion="active"] .vhs-tracking-error,
      [data-motion="active"] .vhs-dropout,
      [data-motion="active"] .crt-retrace-sweep,
      [data-motion="active"] .vhs-sweep {
        display: block;
      }
    </style>
  </head>
  <body data-loading="true">
    <div id="svg-filters-container"></div>

    <div class="bg-container" id="bg-container"></div>

    <header>
      <h1 id="glitch-title" class="name-title">TRAVIS&nbsp;INSKEEP</h1>
      <nav>
        <ul id="nav-list">
          <li><a href="#about">About</a></li>
          <li><a href="#portfolio">Portfolio</a></li>
          <li><a href="#contact">Contact</a></li>
        </ul>
      </nav>
    </header>

    <!-- Mini window overlay container -->
    <div id="mini-overlay"></div>

    <!-- CRT Effect Layers -->
    <div class="vhs-signal-layer"></div>
    <div class="crt-flicker-layer"></div>
    <div class="crt-phosphor-dots"></div>
    <div class="crt-scanlines"></div>
    <div class="vhs-head-switch" id="vhsHeadSwitch"></div>
    <div class="vhs-chroma-noise"></div>
    <div class="composite-artifacts"></div>
    <div class="crt-vignette"></div>
    <div class="vhs-tracking-error" id="vhsTracking"></div>
    <div class="vhs-dropout" id="vhsDropout"></div>
    <div class="crt-retrace-sweep" id="crtRetrace"></div>
    <div class="vhs-sweep"></div>

    <!-- Scanline Sweep Effect -->
    <div class="scanline-sweep" id="scanlineSweep"></div>

    <!-- Scripts load order: Config, Resources, Core System, Physics, Director, Components -->
    <script defer src="assets/js/CRTConfig.js"></script>
    <script defer src="assets/js/CRTResource.js"></script>
    <script defer src="assets/js/CRTSystem.js"></script>
    <script defer src="assets/js/crt-physics-enhanced.js"></script>
    <script defer src="assets/js/crt-director.js"></script>

    <!-- Component Scripts - Load after core system and physics -->
    <script defer src="assets/js/performance-monitor.js"></script>
    <script defer src="assets/js/title-glitch-enhanced.js"></script>
    <script defer src="assets/js/nav-glitch-enhanced.js"></script>
    <script defer src="assets/js/crt-tracking-error.js"></script>
    <script defer src="assets/js/bg-loader.js"></script>
    <script defer src="assets/js/mini-windows.js"></script>
    <script defer src="assets/js/crt-effects.js"></script>

    <!-- SVG Filters Initialization -->
    <script>
      // Load SVG filters immediately for CRT effects
      document.addEventListener("DOMContentLoaded", function () {
        const container = document.getElementById("svg-filters-container");
        if (container) {
          fetch("assets/html/svg-filters.html")
            .then((response) => response.text())
            .then((svgContent) => {
              container.innerHTML = svgContent;
            })
            .catch((error) => {
              console.warn("[SVG] Failed to load filters:", error);
            });
        }
      });

      // Remove loading state once everything is initialized
      window.addEventListener("load", function () {
        // Wait for CRT system to initialize and check system readiness
        const checkSystemReady = () => {
          // Check if core systems are available
          const crtSystemReady = window.CRTSystem;
          const configReady = window.CRTConfig;

          if (crtSystemReady && configReady) {
            const body = document.body;
            if (body) {
              body.removeAttribute("data-loading");
              console.log("[System] Loading complete - site ready");
              console.log("[System] CRT System available:", !!window.CRTSystem);
              console.log("[System] CRT Config available:", !!window.CRTConfig);
            }
          } else {
            // Retry after a short delay if systems aren't ready
            setTimeout(checkSystemReady, 50);
          }
        };

        // Start checking after initial delay
        setTimeout(checkSystemReady, 100);
      });
    </script>
  </body>
</html>
