/* EXTREME VHS + CRT Effects - MAXIMUM CHAOS */

/* Phase 4: Enhanced Visual Hierarchy & Authenticity */

/* Optimized Z-Index Hierarchy for Maximum Authenticity */
:root {
  --vhs-desaturation: 0.94;
  --phosphor-green: rgba(100, 255, 150, 0.02);
  --crt-glow: rgba(0, 255, 200, 0.12);
  --vhs-warm: rgba(255, 220, 180, 0.008);
  
  /* Phase 4: Authentic intensity scaling */
  --phosphor-intensity-max: 1.2; /* Allow over-saturation */
  --convergence-error-scale: 2.4; /* Parabolic convergence scaling */
  --thermal-color-shift: 0.3; /* Color temperature shift factor */
}

/* Background Effects Layer (z-index -2 to 0) */
.bg-container { z-index: -2; }

/* VHS Signal Processing Layer (z-index 1-3) */
.vhs-signal-layer {
  z-index: 1;
  /* Enhanced VHS signal processing with thermal influence */
  backdrop-filter: 
    saturate(calc(var(--vhs-desaturation) + var(--thermal-color-shift) * 0.1)) 
    sepia(calc(0.04 + var(--thermal-color-shift) * 0.08))
    hue-rotate(calc(1deg + var(--thermal-color-shift) * 3deg));
  
  /* Dynamic background intensity response */
  background: 
    linear-gradient(
      180deg,
      var(--vhs-warm) 0%,
      rgba(255, 220, 180, calc(0.012 + var(--crt-background-intensity, 0.5) * 0.008)) 50%,
      var(--vhs-warm) 100%
    );
  opacity: 0.08; /* REDUCED from 0.18 - much more subtle */
}

.vhs-wow-flutter { z-index: 2; }
.crt-vignette { z-index: 3; }

/* Scanlines & Interlacing Layer (z-index 4-6) */
.interlace-field-odd,
.interlace-field-even { z-index: 4; }

.crt-scanlines {
  z-index: 5;
  /* Enhanced authentic scanline patterns */
  background-image: 
    repeating-linear-gradient(
      rgba(0,0,0,0.65) 0px,      
      rgba(0,0,0,0.45) 0.6px,    
      transparent 1.2px,
      rgba(0,0,0,0.6) 2.1px,    
      transparent 2.8px,
      rgba(0,0,0,0.55) 3.9px,    
      transparent 4.7px,
      rgba(0,0,0,0.5) 5.3px,    
      transparent 6.8px,
      rgba(0,0,0,0.65) 7.4px,
      transparent 8.9px
    );
  
  /* Dynamic opacity based on background intensity */
  opacity: 0.4; /* REDUCED from 0.8 - much more subtle */
}

.scanline-interaction { z-index: 6; }

/* Tracking & Signal Errors Layer (z-index 7-9) */
.vhs-tracking-error { z-index: 7; }
.vhs-head-switch { z-index: 8; }
.vhs-dropout { z-index: 9; }

/* Content Layer (z-index 20-22) */
header { z-index: 20; }
#glitch-title { z-index: 21; }
nav { z-index: 21; }
footer { z-index: 22; }

/* Phosphor Persistence Layer (z-index 23-24) */
.phosphor-trails { 
  z-index: 23;
  /* Enhanced phosphor trail container */
  pointer-events: none;
  overflow: hidden;
  
  /* Authentic P22 phosphor glow */
  filter: blur(0.1px) brightness(1.1);
}

.phosphor-burn-layer { z-index: 24; }

/* Sweep Effects Layer (z-index 25-27) - DRAMATICALLY REDUCED INTENSITY */
.crt-retrace-sweep { 
  z-index: 25;
  /* MUCH MORE SUBTLE retrace - nearly invisible */
  background: 
    linear-gradient(
      to bottom,
      transparent 0%,
      rgba(0, 255, 200, 0.05) 15%, /* DRAMATICALLY REDUCED from 0.5 */
      rgba(255, 255, 255, 0.08) 35%, /* DRAMATICALLY REDUCED from 0.7 */
      rgba(0, 255, 200, 0.06) 60%, /* DRAMATICALLY REDUCED from 0.6 */
      rgba(255, 220, 180, 0.03) 80%, /* DRAMATICALLY REDUCED from 0.35 */
      transparent 100%
    );
}

.vhs-sweep { 
  z-index: 26;
  /* MUCH MORE SUBTLE VHS sweep - nearly invisible */
  background: 
    linear-gradient(
      to bottom,
      transparent 0%,
      rgba(0, 255, 200, 0.04) 8%, /* DRAMATICALLY REDUCED from 0.6 */
      rgba(255, 255, 255, 0.06) 25%, /* DRAMATICALLY REDUCED from 0.8 */
      rgba(0, 255, 200, 0.05) 45%, /* DRAMATICALLY REDUCED from 0.7 */
      rgba(255, 100, 150, 0.03) 65%, /* DRAMATICALLY REDUCED from 0.45 */
      rgba(255, 220, 180, 0.02) 80%, /* DRAMATICALLY REDUCED from 0.35 */
      rgba(0, 255, 200, 0.02) 90%, /* DRAMATICALLY REDUCED from 0.25 */
      transparent 100%
    );
}

/* Extreme Degradation Effects (z-index 28-35) */
.vhs-tape-stretch { z-index: 28; }
.vhs-signal-dropout { z-index: 29; }
.vhs-head-clog { z-index: 30; }
.vhs-chroma-crawl { z-index: 31; }
.vhs-speed-wobble { z-index: 32; }
.vhs-edge-damage { z-index: 33; }

/* CRT Monitor Effects (z-index 36-40) */
.crt-focus-drift { z-index: 36; }
.crt-power-ripple { z-index: 37; }
.crt-hsync-error { z-index: 38; }
.crt-vsync-roll { z-index: 39; }

/* Mini Windows (z-index 100+) */
.mini-backdrop { z-index: 99; }
.mini { z-index: 100; }

/* Enhanced Phosphor Effects with Authentic P22 Simulation */
.tg-letter.phosphor-glow {
  /* Wavelength-accurate P22 phosphor emission */
  text-shadow: 
    0 0 1px currentColor,
    0 0 4px rgba(255, 64, 32, 0.8),   /* P22 red phosphor (625nm) */
    0 0 8px rgba(32, 255, 64, 0.9),   /* P22 green phosphor (525nm) */
    0 0 12px rgba(64, 128, 255, 0.7), /* P22 blue phosphor (450nm) */
    0 0 24px rgba(232, 227, 216, 0.6),
    0 0 48px rgba(0, 255, 200, 0.3);
  
  /* Intensity-dependent brightness scaling */
  filter: brightness(calc(1.2 * var(--phosphor-intensity-max, 1.2))) 
          contrast(calc(1.1 + var(--thermal-color-shift, 0) * 0.2));
  
  transition: all 0.03s ease-out; /* Faster phosphor response */
}

.tg-letter.phosphor-burn {
  /* Authentic phosphor burn-in with reduced efficiency */
  text-shadow: 
    0 0 1px currentColor,
    0 0 2px rgba(232, 227, 216, 1.0),
    0 0 4px rgba(232, 227, 216, 0.8),
    0 0 8px rgba(0, 255, 200, 0.4);
  
  filter: brightness(calc(0.7 + var(--thermal-color-shift, 0) * 0.3)) 
          contrast(calc(0.9 + var(--thermal-color-shift, 0) * 0.2))
          sepia(calc(var(--thermal-color-shift, 0) * 0.3));
  
  opacity: calc(0.75 - var(--thermal-color-shift, 0) * 0.1);
}

/* Enhanced Color Bleeding Zones with Electron Path Simulation */
.color-bleed-zone {
  position: absolute;
  border-radius: 50%;
  pointer-events: none;
  
  /* Authentic electron beam path simulation */
  background: radial-gradient(
    ellipse 120% 80% at center,
    rgba(255, 64, 32, calc(0.08 * var(--phosphor-intensity-max, 1.2))) 0%,
    rgba(64, 128, 255, calc(0.06 * var(--phosphor-intensity-max, 1.2))) 40%,
    rgba(32, 255, 64, calc(0.04 * var(--phosphor-intensity-max, 1.2))) 70%,
    transparent 90%
  );
  
  filter: blur(calc(1px + var(--thermal-color-shift, 0) * 2px));
  animation: authenticColorBleed 0.8s ease-out forwards;
}

/* Enhanced Convergence Error Simulation */
.convergence-error-red {
  text-shadow: 
    calc(var(--convergence-error-scale, 2.4) * 1px) 0 rgba(255, 64, 32, 0.8),
    0 0 4px rgba(255, 64, 32, 0.4);
}

.convergence-error-blue {
  text-shadow: 
    calc(var(--convergence-error-scale, 2.4) * -1px) 0 rgba(64, 128, 255, 0.8),
    0 0 4px rgba(64, 128, 255, 0.4);
}

.convergence-error-green {
  text-shadow: 
    0 calc(var(--convergence-error-scale, 2.4) * 0.3px) rgba(32, 255, 64, 0.8),
    0 0 4px rgba(32, 255, 64, 0.4);
}

/* Enhanced Interlacing with Authentic Field Timing */
.interlace-field-odd,
.interlace-field-even {
  background-image: repeating-linear-gradient(
    0deg,
    transparent 0px,
    rgba(0, 0, 0, calc(0.12 + var(--crt-background-intensity, 0.5) * 0.08)) 1px,
    transparent 2px,
    transparent 4px
  );
  
  /* 59.94Hz field rate simulation */
  animation: authenticInterlace 0.0336s steps(2) infinite;
}

.interlace-field-even {
  background-position: 0 1px;
  animation-delay: 0.0168s; /* Half field offset */
}

/* Phase 4: Authentic Animation Keyframes */
@keyframes authenticColorBleed {
  0% { 
    opacity: 0;
    transform: scale(0.3) rotate(0deg);
  }
  30% { 
    opacity: calc(0.8 * var(--phosphor-intensity-max, 1.2));
    transform: scale(1.4) rotate(2deg);
  }
  70% { 
    opacity: calc(0.4 * var(--phosphor-intensity-max, 1.2));
    transform: scale(2.2) rotate(-1deg);
  }
  100% { 
    opacity: 0;
    transform: scale(3) rotate(0deg);
  }
}

@keyframes authenticInterlace {
  0% { opacity: calc(0.7 + var(--crt-background-intensity, 0.5) * 0.2); }
  50% { opacity: calc(0.3 + var(--crt-background-intensity, 0.5) * 0.2); }
  100% { opacity: calc(0.7 + var(--crt-background-intensity, 0.5) * 0.2); }
}

/* Enhanced Thermal Response Animations */
@keyframes thermalColorShift {
  0% { 
    filter: hue-rotate(0deg) sepia(0);
  }
  50% { 
    filter: hue-rotate(calc(var(--thermal-color-shift, 0) * 15deg)) 
            sepia(calc(var(--thermal-color-shift, 0) * 0.2));
  }
  100% { 
    filter: hue-rotate(calc(var(--thermal-color-shift, 0) * 10deg)) 
            sepia(calc(var(--thermal-color-shift, 0) * 0.15));
  }
}

/* Performance-Aware Authenticity Scaling */
.perf-low {
  --phosphor-intensity-max: 0.8;
  --convergence-error-scale: 1.2;
  --thermal-color-shift: 0.1;
}

.perf-medium {
  --phosphor-intensity-max: 1.0;
  --convergence-error-scale: 1.8;
  --thermal-color-shift: 0.2;
}

.perf-high {
  --phosphor-intensity-max: 1.2;
  --convergence-error-scale: 2.4;
  --thermal-color-shift: 0.3;
}

/* VHS signal processing with enhanced tape interaction */
.vhs-signal-layer {
  position: fixed;
  inset: 0;
  z-index: 3; /* BEHIND scanlines */
  pointer-events: none;
  
  backdrop-filter: 
    saturate(var(--vhs-desaturation)) 
    sepia(0.04)
    hue-rotate(1deg);
  -webkit-backdrop-filter: 
    saturate(var(--vhs-desaturation)) 
    sepia(0.04)
    hue-rotate(1deg);
  
  background: 
    linear-gradient(
      180deg,
      var(--vhs-warm) 0%,
      rgba(255, 220, 180, 0.012) 50%,
      var(--vhs-warm) 100%
    );
  filter: url(#vhs-chroma-bleed);
  opacity: 0.08; /* REDUCED from 0.18 - much more subtle */
}

/* EXTREME scanlines - chaotic and irregular */
.crt-scanlines {
  position: fixed;
  inset: 0;
  z-index: 5; /* BEHIND content but above background */
  pointer-events: none;
  mix-blend-mode: multiply;
  
  /* ORGANIC SCANLINE PATTERN that content sits on top of */
  background-image: 
    repeating-linear-gradient(
      rgba(0,0,0,0.7) 0px,      /* REDUCED intensity */
      rgba(0,0,0,0.5) 0.6px,    
      transparent 1.2px,
      rgba(0,0,0,0.65) 2.1px,    
      transparent 2.8px,
      rgba(0,0,0,0.6) 3.9px,    
      transparent 4.7px,
      rgba(0,0,0,0.55) 5.3px,    
      transparent 6.8px,
      rgba(0,0,0,0.7) 7.4px,
      transparent 8.9px
    );
  
  opacity: 0.4; /* REDUCED - scanlines are the medium, not the overlay */
  animation: 
    scanlineMovement 6s linear infinite, 
    scanlineFlicker 8s ease-in-out infinite,
    scanlineBowing 10s ease-in-out infinite,
    scanlineWarp 15s ease-in-out infinite;
  
  /* Less aggressive masking - content needs to be visible */
  mask-image: 
    radial-gradient(
      ellipse 92% 88% at center, 
      rgba(0,0,0,1) 75%, 
      rgba(0,0,0,0.9) 90%, 
      rgba(0,0,0,0.6) 98%,
      transparent 100%
    );
  -webkit-mask-image: 
    radial-gradient(
      ellipse 92% 88% at center, 
      rgba(0,0,0,1) 75%, 
      rgba(0,0,0,0.9) 90%, 
      rgba(0,0,0,0.6) 98%,
      transparent 100%
    );
}

/* NEW: Scanline interaction with content brightness */
.scanline-interaction {
  position: fixed;
  inset: 0;
  z-index: 6; /* ABOVE scanlines, BELOW content */
  pointer-events: none;
  opacity: 0;
  background: transparent;
  mix-blend-mode: screen;
  transition: opacity 0.3s ease;
}

/* When content is bright, scanlines become more visible around it */
.tg-letter:hover ~ .scanline-interaction,
#nav-list a:hover ~ .scanline-interaction {
  opacity: 0.3;
  background: radial-gradient(
    circle at var(--cursor-x, 50%) var(--cursor-y, 50%),
    rgba(0, 255, 200, 0.1) 0%,
    rgba(0, 255, 200, 0.05) 30%,
    transparent 60%
  );
}

/* DRAMATIC CRT vignette - much more pronounced */
.crt-vignette {
  position: fixed;
  inset: 0;
  z-index: 2; /* BEHIND everything */
  pointer-events: none;
  
  /* EXTREME VIGNETTE LAYERS */
  background: 
    /* Primary corner darkening - MUCH STRONGER */
    radial-gradient(
      ellipse 75% 70% at 50% 50%, 
      rgba(0,0,0,0) 40%, 
      rgba(0,0,0,0.2) 65%,
      rgba(0,0,0,0.4) 80%,
      rgba(0,0,0,0.7) 92%,
      rgba(0,0,0,0.9) 100%
    ),
    /* Color temperature shift - DRAMATIC */
    radial-gradient(
      ellipse 85% 80% at 50% 50%,
      transparent 50%,
      rgba(255,220,180,0.08) 75%,
      rgba(0,100,150,0.12) 90%,
      rgba(50,0,100,0.15) 100%
    );
  
  mix-blend-mode: multiply;
  opacity: 0.5; /* REDUCED from 0.9 - less dramatic */
}

/* Sweeps moved ABOVE scanlines for visibility - 7% LESS visible */
.crt-retrace-sweep {
  position: fixed;
  left: 0;
  right: 0;
  top: -12vh;
  height: 18vh;
  z-index: 25;
  pointer-events: none;
  opacity: 0;
  
  background: 
    linear-gradient(
      to bottom,
      transparent 0%,
      rgba(0, 255, 200, 0.558) 15%, /* 7% REDUCTION from 0.6 */
      rgba(255, 255, 255, 0.744) 35%, /* 7% REDUCTION from 0.8 */
      rgba(0, 255, 200, 0.651) 60%, /* 7% REDUCTION from 0.7 */
      rgba(255, 220, 180, 0.372) 80%, /* 7% REDUCTION from 0.4 */
      transparent 100%
    );
  
  backdrop-filter: 
    brightness(1.162) /* 7% REDUCTION from 1.25 */
    blur(0.3px)
    contrast(1.0695); /* 7% REDUCTION from 1.15 */
  -webkit-backdrop-filter: 
    brightness(1.162)
    blur(0.3px)
    contrast(1.0695);
  
  box-shadow: 
    0 0 60px rgba(0, 255, 200, 0.744), /* 7% REDUCTION from 0.8 */
    0 0 120px rgba(0, 255, 200, 0.372); /* 7% REDUCTION from 0.4 */
  
  will-change: transform, opacity;
}

.vhs-sweep {
  position: fixed;
  left: 0;
  right: 0;
  top: -25vh;
  height: 30vh;
  z-index: 26;
  pointer-events: none;
  opacity: 0;
  
  background: 
    linear-gradient(
      to bottom,
      transparent 0%,
      rgba(0, 255, 200, 0.651) 8%, /* 7% REDUCTION from 0.7 */
      rgba(255, 255, 255, 0.837) 25%, /* 7% REDUCTION from 0.9 */
      rgba(0, 255, 200, 0.744) 45%, /* 7% REDUCTION from 0.8 */
      rgba(255, 100, 150, 0.465) 65%, /* 7% REDUCTION from 0.5 */
      rgba(255, 220, 180, 0.372) 80%, /* 7% REDUCTION from 0.4 */
      rgba(0, 255, 200, 0.279) 90%, /* 7% REDUCTION from 0.3 */
      transparent 100%
    );
  
  backdrop-filter: 
    contrast(1.209) /* 7% REDUCTION from 1.3 */
    brightness(1.116) /* 7% REDUCTION from 1.2 */
    blur(0.5px)
    saturate(1.0695); /* 7% REDUCTION from 1.15 */
  -webkit-backdrop-filter: 
    contrast(1.209)
    brightness(1.116)
    blur(0.5px)
    saturate(1.0695);
  
  box-shadow: 
    0 0 80px rgba(0, 255, 200, 0.837), /* 7% REDUCTION from 0.9 */
    0 0 160px rgba(0, 255, 200, 0.465), /* 7% REDUCTION from 0.5 */
    0 0 240px rgba(255, 220, 180, 0.279); /* 7% REDUCTION from 0.3 */
  
  will-change: transform, opacity;
}

/* NEW: Proper interlacing with field flicker */
.interlace-field-odd,
.interlace-field-even {
  position: fixed;
  inset: 0;
  z-index: 4;
  pointer-events: none;
  opacity: 0;
  background-image: repeating-linear-gradient(
    0deg,
    transparent 0px,
    rgba(0, 0, 0, 0.15) 1px,
    transparent 2px,
    transparent 4px
  );
  animation: interlaceFlicker 0.033s steps(2) infinite;
}

.interlace-field-even {
  background-position: 0 1px;
  animation-delay: 0.0165s; /* Half frame offset */
}

/* NEW: Phosphor persistence trails container */
.phosphor-trails {
  position: fixed;
  inset: 0;
  z-index: 19;
  pointer-events: none;
  overflow: hidden;
}

/* NEW: Color bleeding zones */
.color-bleed-zone {
  position: absolute;
  border-radius: 50%;
  pointer-events: none;
  background: radial-gradient(
    circle,
    rgba(255, 64, 32, 0.1) 0%,
    rgba(64, 128, 255, 0.08) 40%,
    transparent 70%
  );
  filter: blur(2px);
  animation: colorBleedPulse 0.5s ease-out forwards;
}

/* NEW: Signal integration keyframes */
@keyframes interlaceFlicker {
  0% { opacity: 0.8; }
  50% { opacity: 0.4; }
  100% { opacity: 0.8; }
}

@keyframes colorBleedPulse {
  0% { 
    opacity: 0;
    transform: scale(0.5);
  }
  50% { 
    opacity: 0.6;
    transform: scale(1.2);
  }
  100% { 
    opacity: 0;
    transform: scale(2);
  }
}

/* EXTREME VHS TAPE DEGRADATION EFFECTS */

.vhs-tape-stretch {
  position: fixed;
  inset: 0;
  z-index: 31;
  pointer-events: none;
  opacity: 0;
  filter: url(#vhs-tape-stretch);
  background: linear-gradient(90deg, 
    rgba(0,0,0,0.1) 0%, 
    rgba(255,255,255,0.05) 20%, 
    rgba(0,0,0,0.1) 40%,
    rgba(255,255,255,0.05) 60%, 
    rgba(0,0,0,0.1) 80%, 
    rgba(255,255,255,0.05) 100%);
  transform: scaleX(1.02);
}

.vhs-signal-dropout {
  position: fixed;
  left: 10%;
  width: 80%;
  top: 30%;
  height: 40%;
  z-index: 32;
  pointer-events: none;
  opacity: 0;
  background: radial-gradient(ellipse 60% 30% at center,
    rgba(0,0,0,0.9) 0%,
    rgba(0,0,0,0.6) 40%,
    rgba(100,100,100,0.3) 70%,
    transparent 100%);
  mix-blend-mode: multiply;
}

.vhs-head-clog {
  position: fixed;
  inset: 0;
  z-index: 33;
  pointer-events: none;
  opacity: 0;
  background-image: repeating-linear-gradient(
    0deg,
    rgba(0,0,0,0.8) 0px,
    rgba(0,0,0,0.8) 2px,
    transparent 2px,
    transparent 8px,
    rgba(0,0,0,0.6) 8px,
    rgba(0,0,0,0.6) 12px,
    transparent 12px,
    transparent 25px
  );
  mix-blend-mode: multiply;
}

.vhs-chroma-crawl {
  position: fixed;
  inset: 0;
  z-index: 34;
  pointer-events: none;
  opacity: 0;
  filter: url(#chroma-crawl);
  background: linear-gradient(45deg,
    rgba(255,0,100,0.1) 0%,
    rgba(0,255,200,0.1) 50%,
    rgba(255,0,100,0.1) 100%);
}

.vhs-speed-wobble {
  position: fixed;
  inset: 0;
  z-index: 35;
  pointer-events: none;
  opacity: 0;
  filter: url(#speed-wobble);
}

.crt-focus-drift {
  position: fixed;
  inset: 0;
  z-index: 36;
  pointer-events: none;
  opacity: 0;
  backdrop-filter: blur(0.8px) brightness(0.95);
  -webkit-backdrop-filter: blur(0.8px) brightness(0.95);
}

.crt-power-ripple {
  position: fixed;
  inset: 0;
  z-index: 37;
  pointer-events: none;
  opacity: 0;
  background-image: repeating-linear-gradient(
    0deg,
    transparent 0px,
    rgba(255,255,255,0.02) 8px,
    transparent 16px,
    rgba(0,0,0,0.03) 24px,
    transparent 32px
  );
  animation: powerRipple 0.033s linear infinite;
}

.crt-hsync-error {
  position: fixed;
  inset: 0;
  z-index: 38;
  pointer-events: none;
  opacity: 0;
  transform: translateX(0px);
}

.crt-vsync-roll {
  position: fixed;
  inset: 0;
  z-index: 39;
  pointer-events: none;
  opacity: 0;
  transform: translateY(0px);
}

.vhs-edge-damage {
  position: fixed;
  left: 0;
  right: 0;
  top: 0;
  height: 5px;
  z-index: 35;
  pointer-events: none;
  opacity: 0;
  background: linear-gradient(90deg,
    rgba(0,0,0,0.8) 0%,
    rgba(255,255,255,0.3) 10%,
    rgba(0,0,0,0.9) 20%,
    rgba(255,255,255,0.2) 30%,
    rgba(0,0,0,0.7) 100%);
  mix-blend-mode: multiply;
}

.vhs-wow-flutter {
  position: fixed;
  inset: 0;
  z-index: 4; /* BEHIND scanlines */
  pointer-events: none;
  opacity: 0;
  transform-origin: center;
  animation: wowFlutter 3.7s ease-in-out infinite;
}

/* Text effects */
.tg-letter {
  position: relative;
  display: inline-block;
  transition: filter 0.6s ease;
}

.tg-letter.phosphor-glow {
  text-shadow: 
    0 0 2px currentColor,
    0 0 6px rgba(232, 227, 216, 0.9), /* INCREASED trail intensity */
    0 0 12px rgba(232, 227, 216, 0.6),
    0 0 24px rgba(0, 255, 200, 0.4), /* INCREASED trail glow */
    0 0 48px rgba(0, 255, 200, 0.2);
  filter: brightness(1.4) contrast(1.15); /* MORE intense phosphor */
  
  transition: all 0.05s ease-out; /* FASTER transition for trails */
}

.tg-letter.phosphor-burn {
  text-shadow: 
    0 0 1px currentColor,
    0 0 3px rgba(232, 227, 216, 1.0), /* MAXIMUM burn-in */
    0 0 6px rgba(232, 227, 216, 0.8),
    0 0 12px rgba(0, 255, 200, 0.5);
  filter: brightness(1.25) contrast(1.1);
  opacity: 0.85; /* MORE burn-in dimming */
}

/* Phosphor interaction with scanlines */
.tg-letter:not(.phosphor-glow) {
  /* Normal state - subtle glow */
  text-shadow: 
    0 0 1px currentColor,
    0 0 3px rgba(232, 227, 216, 0.4),
    0 0 6px rgba(232, 227, 216, 0.2);
}

/* Navigation phosphor effects */
#nav-list a:hover {
  text-shadow: 
    0 0 2px currentColor,
    0 0 6px rgba(232, 227, 216, 0.6),
    0 0 12px rgba(232, 227, 216, 0.3),
    0 0 24px rgba(0, 255, 200, 0.15);
  filter: brightness(1.2);
  transition: all 0.2s ease;
}

/* TITLE STYLES */

#glitch-title {
  position: relative;
  display: inline-block;
  overflow: hidden;
  color: #fff;
  font-size: clamp(2.21rem, 5.78vw, 4.76rem); /* 15% smaller than previous clamp(2.6rem, 6.8vw, 5.6rem) */
  text-transform: uppercase;
  letter-spacing: 0.05em;
  filter: brightness(1.1);
  transition: filter 0.3s ease;
}

#glitch-title .tg-letter {
  display: inline-block;
  position: relative;
  font-weight: 700;
  filter: brightness(1.2);
  transition: transform 0.3s ease;
}

/* ANIMATION KEYFRAMES */

@keyframes scanlineWarp {
  0% { 
    transform: perspective(800px) rotateX(0deg) rotateY(0deg);
  }
  25% { 
    transform: perspective(800px) rotateX(0.8deg) rotateY(0.3deg);
  }
  50% { 
    transform: perspective(800px) rotateX(-0.5deg) rotateY(-0.6deg);
  }
  75% { 
    transform: perspective(800px) rotateX(0.6deg) rotateY(0.4deg);
  }
  100% { 
    transform: perspective(800px) rotateX(0deg) rotateY(0deg);
  }
}

@keyframes scanlineMovement {
  0% { 
    background-position: 0 0px;
    transform: translateX(0px) skewX(0deg);
  }
  20% { 
    background-position: 0 8px;
    transform: translateX(1.2px) skewX(0.1deg);
  }
  40% { 
    background-position: 0 16px;
    transform: translateX(-0.8px) skewX(-0.08deg);
  }
  60% { 
    background-position: 0 24px;
    transform: translateX(1.5px) skewX(0.12deg);
  }
  80% { 
    background-position: 0 32px;
    transform: translateX(-1.0px) skewX(-0.06deg);
  }
  100% { 
    background-position: 0 40px;
    transform: translateX(0px) skewX(0deg);
  }
}

@keyframes scanlineFlicker {
  0% { 
    opacity: 0.95; 
    transform: translateY(0px) scaleY(1);
  }
  15% { 
    opacity: 0.7; 
    transform: translateY(1.2px) scaleY(1.02);
  }
  30% { 
    opacity: 1.0; 
    transform: translateY(-0.8px) scaleY(0.98);
  }
  45% { 
    opacity: 0.8; 
    transform: translateY(1.5px) scaleY(1.03);
  }
  60% { 
    opacity: 0.95; 
    transform: translateY(-1.0px) scaleY(0.97);
  }
  75% { 
    opacity: 0.85; 
    transform: translateY(0.6px) scaleY(1.01);
  }
  90% { 
    opacity: 1.0; 
    transform: translateY(-0.4px) scaleY(0.99);
  }
  100% { 
    opacity: 0.95; 
    transform: translateY(0px) scaleY(1);
  }
}

@keyframes scanlineBowing {
  0% { 
    transform: scaleY(1) skewX(0deg) perspective(1000px) rotateX(0deg);
  }
  25% { 
    transform: scaleY(1.008) skewX(0.15deg) perspective(1000px) rotateX(0.3deg);
  }
  50% { 
    transform: scaleY(0.992) skewX(-0.12deg) perspective(1000px) rotateX(-0.2deg);
  }
  75% { 
    transform: scaleY(1.006) skewX(0.18deg) perspective(1000px) rotateX(0.25deg);
  }
  100% { 
    transform: scaleY(1) skewX(0deg) perspective(1000px) rotateX(0deg);
  }
}

@keyframes crtRetraceSweep {
  0%   { 
    transform: translateY(-140vh); 
    opacity: 0;
  }
  8%   { 
    opacity: 0.8;
  }
  50%  { 
    transform: translateY(60vh); 
    opacity: 0.9;
  }
  92%  { 
    opacity: 0.7;
  }
  100% { 
    transform: translateY(240vh); 
    opacity: 0;
  }
}

@keyframes vhsEnhancedSweep {
  0% {
    transform: translateY(-140vh) skewY(-0.8deg);
    opacity: 0;
  }
  12% {
    opacity: 1.0;
  }
  28% {
    transform: translateY(10vh) skewY(-0.3deg);
    opacity: 1.0;
  }
  50% {
    transform: translateY(50vh) skewY(0deg);
    opacity: 0.9;
  }
  72% {
    transform: translateY(90vh) skewY(0.3deg);
    opacity: 0.95;
  }
  88% {
    opacity: 0.7;
  }
  100% {
    transform: translateY(180vh) skewY(0.8deg);
    opacity: 0;
  }
}

@keyframes vhsTrackingVisible {
  0% { opacity: 0; transform: translateX(0px) scaleX(1); }
  3% { opacity: 0.8; transform: translateX(-1.5px) scaleX(0.98); }
  8% { opacity: 0.95; transform: translateX(2.5px) scaleX(1.02); }
  12% { opacity: 0.7; transform: translateX(-0.8px) scaleX(0.99); }
  18% { opacity: 0.85; transform: translateX(1.2px) scaleX(1.01); }
  25% { opacity: 0; transform: translateX(0px) scaleX(1); }
  100% { opacity: 0; transform: translateX(0px) scaleX(1); }
}

@keyframes vhsHeadSwitchVisible {
  0% { opacity: 0; height: 2px; transform: scaleX(1); }
  2% { opacity: 0.9; height: 3px; transform: scaleX(0.95); }
  5% { opacity: 0.7; height: 4px; transform: scaleX(1.05); }
  8% { opacity: 0.5; height: 2px; transform: scaleX(0.98); }
  12% { opacity: 0; height: 2px; transform: scaleX(1); }
  100% { opacity: 0; height: 2px; transform: scaleX(1); }
}

@keyframes vhsSignalFlutter {
  0% { 
    opacity: 0.18;
    filter: url(#vhs-chroma-bleed) hue-rotate(0deg);
  }
  25% { 
    opacity: 0.15;
    filter: url(#vhs-chroma-bleed) hue-rotate(0.5deg);
  }
  50% { 
    opacity: 0.21;
    filter: url(#vhs-chroma-bleed) hue-rotate(-0.3deg);
  }
  75% { 
    opacity: 0.16;
    filter: url(#vhs-chroma-bleed) hue-rotate(0.8deg);
  }
  100% { 
    opacity: 0.18;
    filter: url(#vhs-chroma-bleed) hue-rotate(0deg);
  }
}

@keyframes vhsDropoutFlash {
  0% { opacity: 0; }
  20% { opacity: 0.5; }
  35% { opacity: 0.2; }
  50% { opacity: 0.4; }
  65% { opacity: 0; }
  100% { opacity: 0; }
}

@keyframes vhsTrackingShift {
  0% { transform: translateX(0px) skewX(0deg) scaleX(1); }
  5% { transform: translateX(-2px) skewX(-0.12deg) scaleX(0.997); }
  12% { transform: translateX(2.8px) skewX(0.15deg) scaleX(1.003); }
  20% { transform: translateX(-1.2px) skewX(-0.08deg) scaleX(0.999); }
  28% { transform: translateX(2.2px) skewX(0.11deg) scaleX(1.002); }
  40% { transform: translateX(-1.8px) skewX(-0.09deg) scaleX(0.998); }
  55% { transform: translateX(1.5px) skewX(0.07deg) scaleX(1.001); }
  70% { transform: translateX(-0.8px) skewX(-0.04deg) scaleX(0.9995); }
  85% { transform: translateX(0.6px) skewX(0.03deg) scaleX(1.0005); }
  100% { transform: translateX(0px) skewX(0deg) scaleX(1); }
}

@keyframes phosphorFade {
  0% { 
    opacity: 1; 
    filter: blur(0px);
  }
  50% { 
    opacity: 0.6; 
    filter: blur(0.5px);
  }
  100% { 
    opacity: 0; 
    filter: blur(1px);
  }
}

@keyframes powerRipple {
  0% { background-position: 0 0px; }
  100% { background-position: 0 32px; }
}

@keyframes wowFlutter {
  0% { transform: scaleX(1) skewX(0deg); }
  25% { transform: scaleX(1.003) skewX(0.02deg); }
  50% { transform: scaleX(0.997) skewX(-0.03deg); }
  75% { transform: scaleX(1.002) skewX(0.01deg); }
  100% { transform: scaleX(1) skewX(0deg); }
}

@keyframes tapeStretch {
  0% { transform: scaleX(1.02) skewX(0deg); opacity: 0; }
  20% { opacity: 0.6; }
  40% { transform: scaleX(1.05) skewX(0.1deg); }
  60% { transform: scaleX(1.01) skewX(-0.05deg); }
  80% { opacity: 0.4; }
  100% { transform: scaleX(1.02) skewX(0deg); opacity: 0; }
}

@keyframes signalDropout {
  0% { opacity: 0; transform: translateY(0px); }
  10% { opacity: 0.8; }
  30% { opacity: 0.9; transform: translateY(-2px); }
  50% { opacity: 0.7; transform: translateY(1px); }
  70% { opacity: 0.85; transform: translateY(-1px); }
  90% { opacity: 0.6; }
  100% { opacity: 0; transform: translateY(0px); }
}

@keyframes headClog {
  0% { opacity: 0; transform: translateY(0px); }
  5% { opacity: 0.7; }
  15% { opacity: 0.9; transform: translateY(1px); }
  25% { opacity: 0.6; transform: translateY(-0.5px); }
  35% { opacity: 0.8; }
  45% { opacity: 0; }
  100% { opacity: 0; transform: translateY(0px); }
}

@keyframes chromaCrawl {
  0% { opacity: 0; filter: hue-rotate(0deg); }
  25% { opacity: 0.4; filter: hue-rotate(2deg); }
  50% { opacity: 0.6; filter: hue-rotate(-1deg); }
  75% { opacity: 0.3; filter: hue-rotate(3deg); }
  100% { opacity: 0; filter: hue-rotate(0deg); }
}

@keyframes speedWobble {
  0% { opacity: 0; transform: scaleY(1); }
  20% { opacity: 0.5; transform: scaleY(1.02); }
  40% { opacity: 0.7; transform: scaleY(0.98); }
  60% { opacity: 0.6; transform: scaleY(1.01); }
  80% { opacity: 0.4; transform: scaleY(0.99); }
  100% { opacity: 0; transform: scaleY(1); }
}

@keyframes focusDrift {
  0% { opacity: 0; backdrop-filter: blur(0.8px); }
  30% { opacity: 0.6; backdrop-filter: blur(1.2px); }
  70% { opacity: 0.8; backdrop-filter: blur(0.4px); }
  100% { opacity: 0; backdrop-filter: blur(0.8px); }
}

@keyframes hsyncError {
  0% { opacity: 0; transform: translateX(0px); }
  5% { opacity: 0.8; transform: translateX(-3px); }
  10% { opacity: 0.9; transform: translateX(5px); }
  15% { opacity: 0.7; transform: translateX(-2px); }
  20% { opacity: 0.85; transform: translateX(4px); }
  30% { opacity: 0.6; transform: translateX(-1px); }
  40% { opacity: 0; transform: translateX(0px); }
  100% { opacity: 0; transform: translateX(0px); }
}

@keyframes vsyncRoll {
  0% { opacity: 0; transform: translateY(0px); }
  10% { opacity: 0.7; transform: translateY(-50px); }
  30% { opacity: 0.9; transform: translateY(-150px); }
  50% { opacity: 0.8; transform: translateY(-250px); }
  70% { opacity: 0.6; transform: translateY(-350px); }
  90% { opacity: 0.4; transform: translateY(-450px); }
  100% { opacity: 0; transform: translateY(-550px); }
}

@keyframes edgeDamage {
  0% { opacity: 0; height: 5px; }
  20% { opacity: 0.8; height: 8px; }
  40% { opacity: 0.9; height: 12px; }
  60% { opacity: 0.7; height: 6px; }
  80% { opacity: 0.5; height: 10px; }
  100% { opacity: 0; height: 5px; }
}

/* Violent shake animation for abrupt glitches */
@keyframes violentShake {
  0% { transform: translate(0px, 0px) rotate(0deg); }
  10% { transform: translate(-7px, -4px) rotate(-2deg); }
  20% { transform: translate(-3px, 6px) rotate(2deg); }
  30% { transform: translate(7px, 0px) rotate(0deg); }
  40% { transform: translate(3px, -2px) rotate(2deg); }
  50% { transform: translate(-3px, 6px) rotate(-2deg); }
  60% { transform: translate(-7px, 3px) rotate(0deg); }
  70% { transform: translate(7px, 3px) rotate(-2deg); }
  80% { transform: translate(-3px, -2px) rotate(2deg); }
  90% { transform: translate(3px, 6px) rotate(0deg); }
  100% { transform: translate(0px, 0px) rotate(0deg); }
}

/* Active state classes */
.crt-retrace-sweep.active { animation: crtRetraceSweep 1.2s cubic-bezier(.1,.8,.2,.9) forwards; }
.vhs-sweep.active { animation: vhsEnhancedSweep 1.2s cubic-bezier(.2,.8,.3,.9) forwards; }
.vhs-tracking-error.active { animation: vhsTrackingVisible 1.5s ease-out forwards; }
.vhs-head-switch.active { animation: vhsHeadSwitchVisible 0.12s ease-out forwards; }
.vhs-dropout.active { animation: vhsDropoutFlash 0.3s ease-out forwards; }
.vhs-tape-stretch.active { animation: tapeStretch 2s ease-in-out forwards; }
.vhs-signal-dropout.active { animation: signalDropout 1.5s ease-out forwards; }
.vhs-head-clog.active { animation: headClog 0.8s ease-out forwards; }
.vhs-chroma-crawl.active { animation: chromaCrawl 2.5s ease-in-out forwards; }
.vhs-speed-wobble.active { animation: speedWobble 3s ease-in-out forwards; }
.crt-focus-drift.active { animation: focusDrift 2s ease-in-out forwards; }
.crt-hsync-error.active { animation: hsyncError 1s ease-out forwards; }
.crt-vsync-roll.active { animation: vsyncRoll 4s linear forwards; }
.vhs-edge-damage.active { animation: edgeDamage 1.2s ease-in-out forwards; }

/* Standardized Performance Optimizations */
.perf-low .vhs-signal-layer { display: none; }
.perf-low .crt-scanlines { 
  opacity: 0.3; 
  animation-duration: 30s, 40s, 50s, 75s;
}
.perf-low .crt-vignette { opacity: 0.4; }
.perf-low .crt-retrace-sweep,
.perf-low .vhs-sweep { display: none; }

.perf-medium .vhs-signal-layer { opacity: 0.05; } /* REDUCED from 0.1 */
.perf-medium .crt-scanlines { 
  opacity: 0.25; /* REDUCED from 0.5 */
  animation-duration: 12s, 16s, 20s, 30s;
}
.perf-medium .crt-vignette { opacity: 0.3; } /* REDUCED from 0.6 */

.perf-reduce .vhs-signal-layer { opacity: 0.03; } /* REDUCED from 0.06 */
.perf-reduce .crt-scanlines { opacity: 0.15; } /* REDUCED from 0.25 */
.perf-reduce .crt-vignette { opacity: 0.1; } /* REDUCED from 0.2 */

/* Performance-based animation throttling */
.perf-low * { 
  animation-duration: calc(var(--base-duration, 1s) * 3) !important;
  transition-duration: calc(var(--base-transition, 0.3s) * 2) !important;
}

.perf-medium * {
  animation-duration: calc(var(--base-duration, 1s) * 1.5) !important;
  transition-duration: calc(var(--base-transition, 0.3s) * 1.2) !important;
}

/* GPU acceleration controls */
.perf-low .tg-letter,
.perf-low #nav-list a {
  will-change: auto;
  transform: translateZ(0); /* Force compositing without expensive transforms */
}

/* Performance optimizations */
@media (prefers-reduced-motion: reduce) {
  .vhs-signal-layer,
  .crt-scanlines,
  .crt-vignette,
  .crt-retrace-sweep,
  .vhs-sweep,
  .vhs-tracking-error,
  .vhs-head-switch,
  .vhs-dropout {
    display: none !important;
  }
  .tg-letter { filter: none !important; }
}

[data-motion="paused"] .vhs-signal-layer,
[data-motion="paused"] .crt-scanlines,
[data-motion="paused"] .crt-retrace-sweep,
[data-motion="paused"] .vhs-sweep,
[data-motion="paused"] .vhs-tracking-error,
[data-motion="paused"] .vhs-head-switch,
[data-motion="paused"] .vhs-dropout {
  animation-play-state: paused !important;
  display: none;
}

[data-motion="paused"] .tg-letter { filter: none !important; }

/* Device optimizations */
@media (max-width: 768px) {
  .vhs-signal-layer { opacity: 0.04; } /* REDUCED from 0.08 */
  .crt-scanlines { opacity: 0.2; } /* REDUCED from 0.35 */
  .crt-vignette { opacity: 0.15; } /* REDUCED from 0.3 */
}