/* Balanced VHS + CRT Effects - Properly Visible */

:root {
  --vhs-desaturation: 0.92;
  --phosphor-green: rgba(100, 255, 150, 0.02);
  --crt-glow: rgba(0, 255, 200, 0.12);
}

/* VHS signal processing - DRAMATICALLY INCREASED VISIBILITY */
.vhs-signal-layer {
  position: fixed;
  inset: 0;
  z-index: 36;
  pointer-events: none;
  
  backdrop-filter: 
    saturate(var(--vhs-desaturation)) 
    sepia(0.08);
  -webkit-backdrop-filter: 
    saturate(var(--vhs-desaturation)) 
    sepia(0.08);
  
  filter: url(#vhs-chroma-bleed);
  opacity: 0.25; /* DRAMATICALLY INCREASED from 0.08 */
}

/* Much more visible scanlines */
.crt-scanlines {
  position: fixed;
  inset: 0;
  z-index: 39;
  pointer-events: none;
  mix-blend-mode: normal; /* CHANGED from overlay - use normal for better visibility */
  
  background-image: 
    repeating-linear-gradient(
      rgba(0,0,0,0.35) 0px,  /* MUCH MORE VISIBLE */
      rgba(0,0,0,0.25) 1px,  /* MUCH MORE VISIBLE */
      transparent 2px,
      rgba(0,0,0,0.30) 3px,  /* MUCH MORE VISIBLE */
      transparent 4px
    );
  
  opacity: 0.4; /* DRAMATICALLY INCREASED from 0.15 */
  animation: scanlineFlicker 10s ease-in-out infinite;
  
  mask-image: 
    radial-gradient(
      ellipse 96% 94% at center, 
      rgba(0,0,0,1) 75%, 
      rgba(0,0,0,0.7) 92%, 
      transparent 100%
    );
  -webkit-mask-image: 
    radial-gradient(
      ellipse 96% 94% at center, 
      rgba(0,0,0,1) 75%, 
      rgba(0,0,0,0.7) 92%, 
      transparent 100%
    );
}

/* More visible vignette */
.crt-vignette {
  position: fixed;
  inset: 0;
  z-index: 35;
  pointer-events: none;
  
  background: 
    radial-gradient(
      ellipse 92% 88% at 50% 50%, 
      rgba(0,0,0,0) 70%, 
      rgba(0,0,0,0.04) 85%, 
      rgba(0,0,0,0.08) 95%, 
      rgba(0,0,0,0.15) 100%
    );
  
  mix-blend-mode: multiply;
  opacity: 0.5; /* INCREASED from 0.3 */
}

/* Much more visible sweeps */
.crt-retrace-sweep {
  position: fixed;
  left: 0;
  right: 0;
  top: -12vh;
  height: 18vh;
  z-index: 37;
  pointer-events: none;
  opacity: 0;
  
  background: 
    linear-gradient(
      to bottom,
      transparent 0%,
      rgba(0, 255, 200, 0.20) 20%, /* DOUBLED */
      rgba(255, 255, 255, 0.30) 45%, /* DOUBLED */
      rgba(0, 255, 200, 0.24) 70%, /* DOUBLED */
      transparent 100%
    );
  
  backdrop-filter: 
    brightness(1.12) 
    blur(0.3px);
  -webkit-backdrop-filter: 
    brightness(1.12) 
    blur(0.3px);
  
  box-shadow: 
    0 0 40px rgba(0, 255, 200, 0.4); /* INCREASED */
  
  will-change: transform, opacity;
}

.vhs-sweep {
  position: fixed;
  left: 0;
  right: 0;
  top: -25vh;
  height: 30vh;
  z-index: 38;
  pointer-events: none;
  opacity: 0;
  
  background: 
    linear-gradient(
      to bottom,
      transparent 0%,
      rgba(0, 255, 200, 0.30) 12%, /* MUCH HIGHER */
      rgba(255, 255, 255, 0.45) 30%, /* MUCH HIGHER */
      rgba(0, 255, 200, 0.35) 50%, /* MUCH HIGHER */
      rgba(255, 100, 150, 0.20) 70%, /* MUCH HIGHER */
      rgba(0, 255, 200, 0.15) 85%, /* MUCH HIGHER */
      transparent 100%
    );
  
  backdrop-filter: 
    contrast(1.18) 
    brightness(1.15) 
    blur(0.5px);
  -webkit-backdrop-filter: 
    contrast(1.18) 
    brightness(1.15) 
    blur(0.5px);
  
  box-shadow: 
    0 0 50px rgba(0, 255, 200, 0.5), /* MUCH HIGHER */
    0 0 100px rgba(0, 255, 200, 0.25); /* MUCH HIGHER */
  
  will-change: transform, opacity;
}

/* Text phosphor glow */
.tg-letter {
  position: relative;
  display: inline-block;
  transition: filter 0.6s ease;
}

.tg-letter.phosphor-glow {
  text-shadow: 
    0 0 3px var(--phosphor-green),
    0 0 6px rgba(255, 255, 255, 0.05);
  filter: brightness(1.02);
}

/* FIXED scanline animation - more visible range */
@keyframes scanlineFlicker {
  0% { 
    opacity: 0.4; 
    transform: translateY(0px);
  }
  25% { 
    opacity: 0.35; 
    transform: translateY(0.2px);
  }
  50% { 
    opacity: 0.45; 
    transform: translateY(-0.1px);
  }
  75% { 
    opacity: 0.37; 
    transform: translateY(0.15px);
  }
  100% { 
    opacity: 0.4; 
    transform: translateY(0px);
  }
}

@keyframes vhsTrackingShift {
  0% { transform: translateX(0px) skewX(0deg); }
  25% { transform: translateX(-0.8px) skewX(-0.04deg); }
  50% { transform: translateX(1.0px) skewX(0.06deg); }
  75% { transform: translateX(-0.4px) skewX(-0.02deg); }
  100% { transform: translateX(0px) skewX(0deg); }
}

.horizontal-hold-error {
  animation: vhsTrackingShift 1.3s ease-out forwards;
}

/* Enhanced CRT Retrace Animation */
@keyframes crtRetraceSweep {
  0%   { 
    transform: translateY(-140vh); 
    opacity: 0;
  }
  8%   { 
    opacity: 0.35; /* INCREASED */
  }
  50%  { 
    transform: translateY(60vh); 
    opacity: 0.30; /* INCREASED */
  }
  92%  { 
    opacity: 0.35; /* INCREASED */
  }
  100% { 
    transform: translateY(240vh); 
    opacity: 0;
  }
}

/* Enhanced VHS Sweep Animation */
@keyframes vhsEnhancedSweep {
  0% {
    transform: translateY(-140vh) skewY(-0.8deg);
    opacity: 0;
  }
  12% {
    opacity: 0.95; /* INCREASED */
  }
  28% {
    transform: translateY(10vh) skewY(-0.3deg);
    opacity: 1.0; /* FULL OPACITY */
  }
  50% {
    transform: translateY(50vh) skewY(0deg);
    opacity: 0.85; /* INCREASED */
  }
  72% {
    transform: translateY(90vh) skewY(0.3deg);
    opacity: 0.95; /* INCREASED */
  }
  88% {
    opacity: 0.6; /* INCREASED */
  }
  100% {
    transform: translateY(180vh) skewY(0.8deg);
    opacity: 0;
  }
}

.crt-retrace-sweep.active {
  animation: crtRetraceSweep 0.9s cubic-bezier(.1,.8,.2,.9) forwards;
}

.vhs-sweep.active {
  animation: vhsEnhancedSweep 1.5s cubic-bezier(.2,.8,.3,.9) forwards;
}

/* Performance optimization classes */
.perf-reduce .vhs-signal-layer {
  opacity: 0.15; /* INCREASED for visibility */
}

.perf-reduce .crt-scanlines {
  opacity: 0.2; /* INCREASED for visibility */
}

/* Motion controls */
@media (prefers-reduced-motion: reduce) {
  .vhs-signal-layer,
  .crt-scanlines,
  .crt-vignette,
  .crt-retrace-sweep,
  .vhs-sweep {
    display: none !important;
  }
  
  .tg-letter {
    filter: none !important;
  }
}

[data-motion="paused"] .vhs-signal-layer,
[data-motion="paused"] .crt-scanlines,
[data-motion="paused"] .crt-retrace-sweep,
[data-motion="paused"] .vhs-sweep {
  animation-play-state: paused !important;
  display: none;
}

[data-motion="paused"] .tg-letter {
  filter: none !important;
}

/* Device capability optimizations */
@media (max-width: 768px) {
  .vhs-signal-layer {
    opacity: 0.06;
  }
  
  .crt-scanlines {
    opacity: 0.12;
  }
}